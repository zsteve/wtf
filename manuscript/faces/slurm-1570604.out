/home/syz/sdecouplings/lib/python3.7/site-packages/tensorly/backend/core.py:885: UserWarning: In partial_svd: converting to NumPy. Check SVD_FUNS for available alternatives if you want to avoid this.
  warnings.warn('In partial_svd: converting to NumPy.'
downloading Olivetti faces from https://ndownloader.figshare.com/files/5976027 to /home/syz/scikit_learn_data
Block iteration  0
Mode 0
i = 0 	 dual = 2.031808
i = 10 	 dual = 1.782704
i = 20 	 dual = 1.781008
Mode 1
i = 0 	 dual = 2.135741
i = 10 	 dual = 2.071749
i = 20 	 dual = 2.023128
i = 30 	 dual = 1.989355
i = 40 	 dual = 1.957274
i = 50 	 dual = 1.924746
i = 60 	 dual = 1.901967
i = 70 	 dual = 1.883297
i = 80 	 dual = 1.868918
i = 90 	 dual = 1.858882
Mode 2
i = 0 	 dual = 2.112956
i = 10 	 dual = 2.035720
i = 20 	 dual = 1.990978
i = 30 	 dual = 1.906485
i = 40 	 dual = 1.842032
i = 50 	 dual = 1.793165
i = 60 	 dual = 1.683731
i = 70 	 dual = 1.598657
i = 80 	 dual = 1.555468
i = 90 	 dual = 1.523599
Block iteration  1
Mode 0
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 1
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 2
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Block iteration  2
Mode 0
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 1
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 2
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Block iteration  3
Mode 0
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 1
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 2
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Block iteration  4
Mode 0
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 1
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 2
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Block iteration  5
Mode 0
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 1
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 2
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Block iteration  6
Mode 0
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 1
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 2
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Block iteration  7
Mode 0
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 1
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 2
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Block iteration  8
Mode 0
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 1
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 2
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Block iteration  9
Mode 0
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 1
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Mode 2
Warning: NaN encountered, new lr = 0.500000
i = 0 	 dual = nan
Warning: NaN encountered, new lr = 0.250000
i = 10 	 dual = nan
Warning: NaN encountered, new lr = 0.125000
i = 20 	 dual = nan
Warning: NaN encountered, new lr = 0.062500
i = 30 	 dual = nan
Error: exhausted retries
Traceback (most recent call last):
  File "faces.py", line 113, in <module>
    clust_ot = kmeans.fit_predict(A[0].cpu())
  File "/home/syz/sdecouplings/lib/python3.7/site-packages/sklearn/cluster/_kmeans.py", line 1077, in fit_predict
    return self.fit(X, sample_weight=sample_weight).labels_
  File "/home/syz/sdecouplings/lib/python3.7/site-packages/sklearn/cluster/_kmeans.py", line 982, in fit
    accept_large_sparse=False)
  File "/home/syz/sdecouplings/lib/python3.7/site-packages/sklearn/base.py", line 421, in _validate_data
    X = check_array(X, **check_params)
  File "/home/syz/sdecouplings/lib/python3.7/site-packages/sklearn/utils/validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "/home/syz/sdecouplings/lib/python3.7/site-packages/sklearn/utils/validation.py", line 664, in check_array
    allow_nan=force_all_finite == 'allow-nan')
  File "/home/syz/sdecouplings/lib/python3.7/site-packages/sklearn/utils/validation.py", line 106, in _assert_all_finite
    msg_dtype if msg_dtype is not None else X.dtype)
ValueError: Input contains NaN, infinity or a value too large for dtype('float64').
